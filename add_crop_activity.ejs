<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Add_Crop_Activity</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel='stylesheet' href='/stylesheets/style_index_add.css'/>
  </head>

  <body>
    <h1 class="header">Arable Land Manager Application</h1>

    <div class="nav">
      <ul>
          <li><a href="/">Home</a></li>
          <li><a href="/field">Field</a></li>
          <li><a href="/crop_activity">Crop Activity</a></li>
      </ul>
    </div>

    <h3 class="sub-header">Add Crop Activity</h3>

    <form action="/crop_activity/add" method="post">
      <div class="add_input_1">
        <label for="start_date">Start date - </label>
        <!--<input type="date" id="start_date" onclick="myFunction()">-->
        <input id="start_date" type="text" name="start_date"/>
        <!--<select id="start_date" name="start_date">
          <option id ="start_date" value="start_date">d</option>
        </select>-->
        <!--<p id="start_date" name="start_date" value="start_date"></p><!--causing add problem-->
      </div>
      <div class="add_input_2">
        <label>Next recommended crop:</label>
        <label id="the_Recommended_crop"></label>
      </div>
      <div class="add_input_3">
        <label for="crop">Crop</label>
        <select id="crop_selection" name="crop" onchange="recommeneded_crop_function()" onclick="estimated_finish_function()">
          <option id ="Blank" value="Blank"></option>
          <option id ="Wheat" value="Wheat">Wheat</option>
          <option id ="Potato" value="Potato">Potato</option>
          <option id ="Maize" value="Maize">Maize</option>
          <option id ="Carrot" value="Carrot">Carrot</option>
          <option id ="Barley" value="Barley">Barley</option>
          <option id ="Cabbage" value="Cabbage">Cabbage</option>
          <option id ="Peas" value="Peas">Peas</option>
        </select>
      </div>
      <div class="add_input_4">
        <label>Estimated ready for harvesting time - </label>
        <!--<label id="estimated_finish_date"></label>-->
        <input id="estimated_finish_date" type="text" name="estimated_finish_date"/>
      </div>
      <div class="add_input_5">
        <label for="field_id">Field ID</label>
        <select name="field_id">
          <% for(var i=0; i < crop_activity.length; i++) { %>
            <option value="<%= crop_activity[i].field_id %>"><%= crop_activity[i].field_id %></option>
          <% } %>
        </select>
      </div>

      <script>
        /*
        //recommended crop and estimated finish date combined function (old)
        function add_months(date, months) {
          var d = date.getDate();
          date.setMonth(date.getMonth() + +months);
          if (date.getDate() != d) {
            date.setDate(0);
          }
          return date;
        }

        document.getElementById("start_date").innerHTML = add_months(new Date(),0).toString();
        
        function recommeneded_crop_function() {
          var c = document.getElementById("crop_selection").value;
          if (c == "Blank") {
            document.getElementById("the_Recommended_crop").innerHTML = "";
          }
          else if (c == "Wheat") {
            document.getElementById("the_Recommended_crop").innerHTML = "Peas" + c;
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),4).toString();
          }
          else if (c == "Potato") {
            document.getElementById("the_Recommended_crop").innerHTML = "Wheat" + c;
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),3).toString();
          }
          else if (c == "Maize") {
            document.getElementById("the_Recommended_crop").innerHTML = "Potato" + c;
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),5).toString();
          }
          else if (c == "Carrot") {
            document.getElementById("the_Recommended_crop").innerHTML = "Maize" + c;
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),3).toString();
          }
          else if (c == "Barley") {
            document.getElementById("the_Recommended_crop").innerHTML = "Carrot" + c;
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),4).toString();
          }
          else if (c == "Cabbage") {
            document.getElementById("the_Recommended_crop").innerHTML = "Barley" + c;
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),2).toString();
          }
          else if (c == "Peas") {
            document.getElementById("the_Recommended_crop").innerHTML = "Cabbage" + c;
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),2).toString();
          }
          else {
            document.getElementById("the_Recommended_crop").innerHTML = "";
          }
        }
        */

        
        function recommeneded_crop_function() {
          var c = document.getElementById("crop_selection").value;
          if (c == "Blank") {
            document.getElementById("the_Recommended_crop").innerHTML = "";
          }
          else if (c == "Wheat") {
            document.getElementById("the_Recommended_crop").innerHTML = "Peas";
          }
          else if (c == "Potato") {
            document.getElementById("the_Recommended_crop").innerHTML = "Wheat";
          }
          else if (c == "Maize") {
            document.getElementById("the_Recommended_crop").innerHTML = "Potato";
          }
          else if (c == "Carrot") {
            document.getElementById("the_Recommended_crop").innerHTML = "Maize";
          }
          else if (c == "Barley") {
            document.getElementById("the_Recommended_crop").innerHTML = "Carrot";
          }
          else if (c == "Cabbage") {
            document.getElementById("the_Recommended_crop").innerHTML = "Barley";
          }
          else if (c == "Peas") {
            document.getElementById("the_Recommended_crop").innerHTML = "Cabbage";
          }
          else {
            document.getElementById("the_Recommended_crop").innerHTML = "";
          }
        }


        function add_months(date, months) {
          var d = date.getDate();
          date.setMonth(date.getMonth() + +months);
          if (date.getDate() != d) {
            date.setDate(0);
          }
          return date;
        }

        //document.getElementById("start_date").innerHTML = add_months(new Date(),0).toString();
        //document.getElementById("start_date").innerHTML = "lf";
        document.getElementById("start_date").value = add_months(new Date(),0).toString();
        document.getElementById("start_date").defaultValue = window.location.href.substring(91);
        
        /*function estimated_finish_function() {
          var c = document.getElementById("crop_selection").value;
          if (c == "Blank") {
            document.getElementById("estimated_finish_date").innerHTML = "";
          }
          else if (c == "Wheat") {
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),4).toString();
          }
          else if (c == "Potato") {
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),3).toString();
          }
          else if (c == "Maize") {
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),5).toString();
          }
          else if (c == "Carrot") {
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),3).toString();
          }
          else if (c == "Barley") {
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),4).toString();
          }
          else if (c == "Cabbage") {
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),2).toString();
          }
          else if (c == "Peas") {
            document.getElementById("estimated_finish_date").innerHTML = add_months(new Date(),2).toString();
          }
          else {
            document.getElementById("the_Recommended_crop").innerHTML = "";
          }
        }*/
        function estimated_finish_function() {
          var c = document.getElementById("crop_selection").value;
          if (c == "Blank") {
            document.getElementById("estimated_finish_date").value = "";
          }
          else if (c == "Wheat") {
            document.getElementById("estimated_finish_date").value = add_months(new Date(),4).toString();
          }
          else if (c == "Potato") {
            document.getElementById("estimated_finish_date").value = add_months(new Date(),3).toString();
          }
          else if (c == "Maize") {
            document.getElementById("estimated_finish_date").value = add_months(new Date(),5).toString();
          }
          else if (c == "Carrot") {
            document.getElementById("estimated_finish_date").value = add_months(new Date(),3).toString();
          }
          else if (c == "Barley") {
            document.getElementById("estimated_finish_date").value = add_months(new Date(),4).toString();
          }
          else if (c == "Cabbage") {
            document.getElementById("estimated_finish_date").value = add_months(new Date(),2).toString();
          }
          else if (c == "Peas") {
            document.getElementById("estimated_finish_date").value = add_months(new Date(),2).toString();
          }
          else {
            document.getElementById("the_Recommended_crop").value = "";
          }
        }
      </script>

      <button type="submit" class="crop_activity_input_submit" style="background-color:rgba(5, 150, 0, 0.425)">Add crop activity</button>
    </form>
  </body>
</html>